<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Menú BRUMAE</title>
  <style>
    /* Base styling inspired by the BRUMAE menu */
    body {
      margin: 0;
      font-family: 'Arial', sans-serif;
      background-color: #5e6f55; /* similar green tone to the menu */
      color: #f5f5eb;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }
    .logo {
      text-align: center;
      margin-bottom: 20px;
    }
    .logo img {
      width: 260px;
      height: auto;
    }
    /* Category styles */
    .category {
      margin-bottom: 24px;
      border-bottom: 1px solid rgba(255,255,255,0.2);
    }
    .category-title {
      color: #ebdfc9;
      font-size: 1.3rem;
      font-weight: bold;
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
      padding: 12px 0;
    }
    .category-title .toggle-icon {
      font-size: 1.2rem;
      transition: transform 0.3s ease;
    }
    .category-title.collapsed .toggle-icon {
      transform: rotate(-90deg);
    }
    .category-items {
      display: none;
      padding-bottom: 16px;
    }
    .category-items.open {
      display: block;
    }
    /* Item card */
    .item-card {
      padding: 12px 0;
      border-bottom: 1px solid rgba(255,255,255,0.15);
      cursor: pointer;
    }
    .item-name {
      font-size: 1rem;
      color: #f5f5eb;
      margin: 0;
    }
    .item-desc {
      font-size: 0.85rem;
      color: #d9cab1;
      margin: 4px 0 0;
    }
    .item-price {
      font-weight: bold;
      color: #ebdfc9;
      margin-top: 4px;
    }
    /* Modal overlay */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.6);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .modal-content {
      background-color: #5e6f55;
      padding: 20px;
      border-radius: 8px;
      width: 90%;
      max-width: 500px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.3);
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    .modal-header h3 {
      margin: 0;
      color: #ebdfc9;
    }
    .close-btn {
      background: none;
      border: none;
      color: #ebdfc9;
      font-size: 1.3rem;
      cursor: pointer;
    }
    .modal-body {
      margin-bottom: 20px;
    }
    .modal-body p {
      margin: 6px 0;
      font-size: 0.9rem;
      color: #d9cab1;
    }
    .modal-body textarea {
      width: 100%;
      padding: 6px;
      border: none;
      border-radius: 4px;
      resize: vertical;
      min-height: 60px;
    }
    .quantity-control {
      display: flex;
      align-items: center;
      margin-top: 10px;
    }
    .quantity-control button {
      background-color: #ebdfc9;
      color: #5e6f55;
      border: none;
      width: 32px;
      height: 32px;
      border-radius: 4px;
      font-size: 1rem;
      cursor: pointer;
    }
    .quantity-control input {
      width: 60px;
      text-align: center;
      margin: 0 8px;
      padding: 6px;
      border: none;
      border-radius: 4px;
    }
    .add-btn {
      display: block;
      width: 100%;
      margin-top: 20px;
      background-color: #b85c5c;
      color: #f5f5eb;
      border: none;
      padding: 10px 0;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
    }
    .add-btn:hover {
      background-color: #a24b4b;
    }
    /* Floating summary button */
    .floating-btn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #ebdfc9;
      color: #5e6f55;
      padding: 12px 16px;
      border: none;
      border-radius: 50px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      font-weight: bold;
      cursor: pointer;
      z-index: 900;
    }
    .floating-btn:hover {
      background-color: #d9cab1;
    }
    /* Summary modal */
    .summary-modal-content {
      background-color: #5e6f55;
      padding: 20px;
      border-radius: 8px;
      /* Ajustar ancho de la ventana emergente para que se adapte a diferentes tamaños de pantalla */
      width: 90%;
      max-width: 600px;
      max-height: 85vh;
      overflow-y: auto;
      box-shadow: 0 4px 6px rgba(0,0,0,0.3);
    }
    .summary-modal-content h3 {
      margin-top: 0;
      color: #ebdfc9;
    }
    #summary-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 16px;
    }
    #summary-table th, #summary-table td {
      padding: 8px;
      border-bottom: 1px solid rgba(255,255,255,0.15);
      color: #f5f5eb;
    }
    #summary-table th {
      color: #ebdfc9;
      font-weight: bold;
    }
    .summary-total {
      text-align: right;
      font-weight: bold;
      margin-bottom: 16px;
      color: #ebdfc9;
    }
    .summary-actions {
      text-align: right;
    }
    .confirm-btn {
      background-color: #ebdfc9;
      color: #5e6f55;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
    }
    .confirm-btn:hover {
      background-color: #d9cab1;
    }
    .remove-btn {
      background-color: #b85c5c;
      color: #fff;
      border: none;
      padding: 4px 8px;
      border-radius: 4px;
      cursor: pointer;
    }
    .remove-btn:hover {
      background-color: #a24b4b;
    }

    /* Estilos para los campos de cantidad y comentario en la tabla de resumen */
    #summary-table input[type="number"],
    #summary-table input[type="text"] {
      padding: 4px;
      background-color: #f5f5eb;
      color: #5e6f55;
      border: none;
      border-radius: 4px;
    }
    #summary-table input[type="number"] {
      /* Por defecto, el campo de cantidad es más corto (hasta tres dígitos) */
      width: 25px;
    }
    #summary-table input[type="text"] {
      width: 140px;
    }

    /* Ajustes responsivos para la tabla de resumen en pantallas pequeñas */
    @media (max-width: 500px) {
      #summary-table th,
      #summary-table td {
        font-size: 0.75rem;
        padding: 4px;
      }
      #summary-table input[type="number"] {
        width: 25px;
      }
      #summary-table input[type="text"] {
        width: 100px;
      }
      .summary-modal-content {
        /* En pantallas muy pequeñas, el modal ocupa casi todo el ancho y se adapta en altura */
        width: 95%;
        max-height: 90vh;
      }
    }
    @media (max-width: 600px) {
      .modal-content, .summary-modal-content {
        width: 95%;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="logo">
      <!-- Reference the logo file located in the same directory -->
      <img src="logo brumae.png" alt="BRUMAE logo">
    </div>
    <div id="menu-container"></div>
    <!-- Item detail modal -->
    <div id="item-modal" class="modal-overlay">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="item-modal-title"></h3>
          <button class="close-btn" id="item-modal-close">×</button>
        </div>
        <div class="modal-body">
          <p id="item-modal-desc"></p>
          <!-- Opciones dinámicas del producto -->
          <div id="item-options-container" style="display:none; margin-bottom: 12px;">
            <label for="item-options" style="display:block; margin-bottom:4px; color:#ebdfc9;">Opciones</label>
            <select id="item-options" style="width:100%; padding:6px; border:none; border-radius:4px;"></select>
          </div>
          <label for="item-comment">Instrucciones especiales</label>
          <textarea id="item-comment" placeholder="Añada aquí los comentarios sobre este producto"></textarea>
          <div class="quantity-control">
            <button id="qty-minus">−</button>
            <input type="number" id="item-qty" value="1" min="1">
            <button id="qty-plus">+</button>
          </div>
        </div>
        <button id="item-add-btn" class="add-btn">Agregar al pedido</button>
      </div>
    </div>
    <!-- Summary modal -->
    <div id="summary-modal" class="modal-overlay">
      <div class="summary-modal-content">
        <div class="modal-header">
          <h3>Resumen del pedido</h3>
          <button class="close-btn" id="summary-modal-close">×</button>
        </div>
        <table id="summary-table">
          <thead>
            <tr>
              <th>Producto</th>
              <th>Cant.</th>
              <th>Comentario</th>
              <th>Subtotal</th>
              <th></th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
        <div class="summary-total" id="summary-total"></div>
        <div class="summary-actions">
          <button id="confirm-btn" class="confirm-btn">Confirmar pedido</button>
        </div>
      </div>
    </div>
    <!-- Floating button to view summary -->
    <button id="view-summary-btn" class="floating-btn">Ver pedido</button>
  </div>

  <script>
    // Menú de productos con descripciones y precios en pesos colombianos
    const menuData = {
      "Entradas": [
        { name: "Palitos x4", price: 15000, desc: "" },
        { name: "Queso asado", price: 22000, desc: "" },
        { name: "Empanadas con aji", price: 8000, desc: "" }
      ],
      "Carnes": [
        { name: "Suprema de pollo", price: 30000, desc: "Corte fino de jugosa pechuga de pollo a la parrilla" },
        { name: "Medallones de cerdo", price: 30000, desc: "Seleccionado corte de lomo de cerdo a la parrilla" },
        { name: "Picada para X 2", price: 65000, desc: "Seleccionadas carnes a la parrilla de res (140 gr), pollo (140 gr), cerdo (280 gr), chicharrón (140 gr), chorizos y morcilla; acompañadas con papas a la francesa, ensalada, arepas, tomate y limón." },
        { name: "Salmon a la parrilla", price: 55000, desc: "Delicioso corte de salmón asado a la parrilla en salsa de maracuya" },
        { name: "Punta de anca", price: 45000, desc: "Seleccionado corte de punta de anca en corte fino (mariposa)" },
        { name: "Churrasco", price: 45000, desc: "Seleccionado y jugoso lomo de res en corte mariposa (corte semi-grueso)", options: [ "Termino medio", "3 cuartos", "Bien asada" ] },
        { name: "Lomo fino", price: 50000, desc: "Jugoso y seleccionado lomo de res o Baby Beef (Corte grueso)", options: [ "Termino medio", "3 cuartos", "Bien asada" ] },
        { name: "Costillas", price: 39000, desc: "Seleccionadas costillas de cerdo a la parrilla, bañadas en salsa del chef (BBQ especial)" }
      ],
      "Hamburguesas": [
        { name: "Hamburguesa mixta", price: 32000, desc: "Mix de carnes de res y filete de pechuga de pollo, con queso mozzarella, lechuga, pepinillos agridulces, tomate y tocineta en salsa BBQ", options: [ "Papas a la francesa", "Papas en Cascos" ] },
        { name: "Hamburguesa vegetariana", price: 30000, desc: "Deliciosa proteína a base de lentejas, queso mozzarella y champiñones, pan parmesano artesanal y mix de vegetales: cebolla morada, tomate, guacamole, cogoyo europeo y salsa de ajo", options: [ "Papas a la francesa", "Papas en Cascos" ] },
        { name: "Hamburguesa res", price: 30000, desc: "Deliciosa carne de res (180 gr), acompañado con tocineta salteada en salsa BBQ, tomate, lechuga, queso mozzarella y pepinillos agridulces", options: [ "Papas a la francesa", "Papas en Cascos" ] },
        { name: "Hamburguesa chesse grill", price: 32000, desc: "Deliciosa Carne de res (180 gr) acompañada con un rico queso asado a la parrilla, pan artesanal de orégano, tocineta salteada en salsa BBQ (de la casa), aros de cebolla apanados y mix de vegetales: tomate verde, cogoyo europeo y salsa de leña de la casa", options: [ "Papas a la francesa", "Papas en Cascos" ] },
        { name: "Hamburguesa hawiana", price: 30000, desc: "Pan suave, carne de res (180 gr), piña asada, tomate, lechuga, pepinillos agridulces, queso mozzarella y tocineta salteada", options: [ "Papas a la francesa", "Papas en Cascos" ] },
        { name: "Hamburguesa pollo", price: 35000, desc: "Deliciosa pechuga de pollo a la parrilla (180 gr), acompañado con tocineta salteada en salsa BBQ, tomate, lechuga, queso mozzarella y pepinillos agridulces", options: [ "Papas a la francesa", "Papas en Cascos" ] }
      ],
      "Bebidas": [
        { name: "Jugos en agua", price: 9500, desc: "", options: [ "Fresa", "mora", "mango", "maracuyá", "guanabana" ] },
        { name: "Jugo en leche", price: 12000, desc: "", options: [ "Fresa", "mora", "mango", "maracuyá", "guanabana" ] },
        { name: "Limonada de coco", price: 13000, desc: "" },
        { name: "Limonada cerezada", price: 13000, desc: "" },
        { name: "Sodas saborizadas", price: 13000, desc: "", options: [ "frutos rojos", "maracuyá", "manzana" ] },
        { name: "Gaseosa", price: 6500, desc: "", options: [ "Coca cola", "coca cola 0", "manzana", "colombiana", "cuatro", "premio" ] },
        { name: "Te Hatsu", price: 9500, desc: "", options: [ "negro", "rojo", "blanco" ] }
      ],
      "Licores": [
        { name: "Aguandiente media", price: 65000, desc: "" },
        { name: "Aguandiente litro", price: 110000, desc: "" },
        { name: "Ron media", price: 70000, desc: "" },
        { name: "Ron botella", price: 110000, desc: "" },
        { name: "Tequila media", price: 85000, desc: "" },
        { name: "Tequila botella", price: 130000, desc: "" },
        { name: "Wiski  media", price: 120000, desc: "" },
        { name: "Wiski botella", price: 220000, desc: "" },
        { name: "Cervezas nacional", price: 9000, desc: "", options: [ "aguila", "aguila light", "pilsen", "club colombia" ] },
        { name: "Tres cordilleras", price: 14000, desc: "", options: [ "rosada", "mestiza", "mulata", "blanca", "negra", "mona" ] },
        { name: "Corona", price: 14000, desc: "" }
      ]
    };

    // Array para almacenar el pedido
    const order = [];

    // Construye la interfaz del menú como acordeones y tarjetas
    const menuContainer = document.getElementById('menu-container');
    Object.keys(menuData).forEach(category => {
      const categoryDiv = document.createElement('div');
      categoryDiv.className = 'category';
      const titleDiv = document.createElement('div');
      titleDiv.className = 'category-title';
      const titleSpan = document.createElement('span');
      titleSpan.textContent = category;
      const toggleIcon = document.createElement('span');
      toggleIcon.className = 'toggle-icon';
      toggleIcon.textContent = '►';
      titleDiv.appendChild(titleSpan);
      titleDiv.appendChild(toggleIcon);
      const itemsDiv = document.createElement('div');
      itemsDiv.className = 'category-items';
      // Toggle display on title click
      titleDiv.addEventListener('click', () => {
        const isOpen = itemsDiv.classList.contains('open');
        itemsDiv.classList.toggle('open');
        // rotate icon when collapsed
        if (isOpen) {
          titleDiv.classList.remove('collapsed');
        } else {
          titleDiv.classList.add('collapsed');
        }
      });
      menuData[category].forEach((item, index) => {
        const card = document.createElement('div');
        card.className = 'item-card';
        const nameEl = document.createElement('div');
        nameEl.className = 'item-name';
        nameEl.textContent = item.name;
        const descEl = document.createElement('div');
        descEl.className = 'item-desc';
        descEl.textContent = item.desc;
        const priceEl = document.createElement('div');
        priceEl.className = 'item-price';
        priceEl.textContent = `$${item.price.toLocaleString('es-CO')}`;
        card.appendChild(nameEl);
        card.appendChild(descEl);
        card.appendChild(priceEl);
        card.addEventListener('click', () => openItemModal(category, index));
        itemsDiv.appendChild(card);
      });
      categoryDiv.appendChild(titleDiv);
      categoryDiv.appendChild(itemsDiv);
      menuContainer.appendChild(categoryDiv);
    });

    /**
     * Añade un elemento al pedido
     */
    function addItemToOrder(category, index, quantity, comment, option = null) {
      const item = menuData[category][index];
      order.push({
        name: item.name,
        price: item.price,
        quantity: quantity,
        comment: comment,
        option: option
      });
      updateSummary();
    }

    // Variables para rastrear el producto actual en el modal
    let currentCategory = '';
    let currentIndex = 0;

    /**
     * Abre el modal con el detalle del producto seleccionado
     */
    function openItemModal(category, index) {
      currentCategory = category;
      currentIndex = index;
      const item = menuData[category][index];
      document.getElementById('item-modal-title').textContent = item.name;
      document.getElementById('item-modal-desc').textContent = item.desc;
      document.getElementById('item-comment').value = '';
      document.getElementById('item-qty').value = 1;
      // Manejar opciones si el producto tiene opciones
      const optionsContainer = document.getElementById('item-options-container');
      const selectEl = document.getElementById('item-options');
      if (item.options && item.options.length > 0) {
        // Limpiar y poblar el select
        selectEl.innerHTML = '';
        item.options.forEach(opt => {
          const optionEl = document.createElement('option');
          optionEl.value = opt;
          optionEl.textContent = opt;
          selectEl.appendChild(optionEl);
        });
        optionsContainer.style.display = 'block';
      } else {
        optionsContainer.style.display = 'none';
        selectEl.innerHTML = '';
      }
      document.getElementById('item-modal').style.display = 'flex';
    }

    /**
     * Cierra el modal del producto
     */
    function closeItemModal() {
      document.getElementById('item-modal').style.display = 'none';
    }

    /**
     * Abre el modal del resumen
     */
    function openSummaryModal() {
      updateSummary();
      document.getElementById('summary-modal').style.display = 'flex';
    }

    /**
     * Cierra el modal del resumen
     */
    function closeSummaryModal() {
      document.getElementById('summary-modal').style.display = 'none';
    }

    /**
     * Actualiza la tabla de resumen, el total y el contador en el botón flotante
     */
    function updateSummary() {
      const tbody = document.querySelector('#summary-table tbody');
      const totalDiv = document.getElementById('summary-total');
      const viewBtn = document.getElementById('view-summary-btn');
      tbody.innerHTML = '';
      // Construir filas con inputs editables para cantidad y comentario
      order.forEach((entry, idx) => {
        const row = document.createElement('tr');
        // Nombre del producto con opción en paréntesis si aplica
        const nameCell = document.createElement('td');
        nameCell.textContent = entry.option ? `${entry.name} (${entry.option})` : entry.name;
        // Cantidad editable
        const qtyCell = document.createElement('td');
        const qtyInput = document.createElement('input');
        qtyInput.type = 'number';
        qtyInput.min = '1';
        qtyInput.value = entry.quantity;
        qtyInput.style.width = '60px';
        qtyInput.addEventListener('change', () => {
          let val = parseInt(qtyInput.value) || 1;
          if (val < 1) val = 1;
          qtyInput.value = val;
          entry.quantity = val;
          // Actualizar el subtotal de esta fila y el total general
          subtotalCell.textContent = `$${(entry.price * entry.quantity).toLocaleString('es-CO')}`;
          recalcTotal();
        });
        qtyCell.appendChild(qtyInput);
        // Comentario editable con opcional etiqueta
        const commentCell = document.createElement('td');
        const commentWrapper = document.createElement('div');
        commentWrapper.style.display = 'flex';
        commentWrapper.style.flexDirection = 'column';
        commentWrapper.style.rowGap = '4px';
        // Mostrar la opción seleccionada de forma no editable en el comentario si existe
        if (entry.option) {
          const optionLabel = document.createElement('div');
          optionLabel.textContent = `Opción: ${entry.option}`;
          optionLabel.style.fontSize = '0.8rem';
          optionLabel.style.color = '#ebdfc9';
          commentWrapper.appendChild(optionLabel);
        }
        const commentInput = document.createElement('input');
        commentInput.type = 'text';
        commentInput.value = entry.comment || '';
        commentInput.placeholder = 'Comentario';
        commentInput.style.width = '140px';
        commentInput.addEventListener('input', () => {
          entry.comment = commentInput.value.trim();
        });
        commentWrapper.appendChild(commentInput);
        commentCell.appendChild(commentWrapper);
        // Subtotal calculado
        const subtotalCell = document.createElement('td');
        subtotalCell.textContent = `$${(entry.price * entry.quantity).toLocaleString('es-CO')}`;
        // Botón para eliminar fila
        const removeCell = document.createElement('td');
        const removeBtn = document.createElement('button');
        // Mostrar un icono más estilizado para eliminar (cruz)
        removeBtn.textContent = '✖';
        removeBtn.className = 'remove-btn';
        // Atributo accesible para lectores de pantalla
        removeBtn.setAttribute('aria-label', 'Eliminar');
        removeBtn.addEventListener('click', () => {
          order.splice(idx, 1);
          updateSummary();
        });
        removeCell.appendChild(removeBtn);
        row.appendChild(nameCell);
        row.appendChild(qtyCell);
        row.appendChild(commentCell);
        row.appendChild(subtotalCell);
        row.appendChild(removeCell);
        tbody.appendChild(row);
      });
      // Recalcula y actualiza el total después de renderizar todas las filas
      recalcTotal();
    }

    /**
     * Recalcula el total del pedido y actualiza el texto del total y el contador
     */
    function recalcTotal() {
      const totalDiv = document.getElementById('summary-total');
      const viewBtn = document.getElementById('view-summary-btn');
      let total = 0;
      order.forEach(entry => {
        total += entry.price * entry.quantity;
      });
      totalDiv.textContent = `Total: $${total.toLocaleString('es-CO')}`;
      if (order.length > 0) {
        viewBtn.textContent = `Ver pedido (${order.length})`;
      } else {
        viewBtn.textContent = 'Ver pedido';
      }
    }

    /**
     * Genera el mensaje de WhatsApp y abre la conversación cuando se confirma el pedido
     */
    document.getElementById('confirm-btn').addEventListener('click', () => {
      if (order.length === 0) {
        alert('No has agregado ningún producto al pedido.');
        return;
      }
      let message = 'Hola, quiero hacer el siguiente pedido:\n';
      let total = 0;
      order.forEach(entry => {
        const subtotal = entry.price * entry.quantity;
        total += subtotal;
        // Incluir opción en el nombre si existe
        let lineName = entry.name;
        if (entry.option) {
          lineName += ` (${entry.option})`;
        }
        message += `${lineName} x${entry.quantity} - $${subtotal.toLocaleString('es-CO')}`;
        if (entry.comment) {
          message += ` (Comentario: ${entry.comment})`;
        }
        message += '\n';
      });
      message += `Total: $${total.toLocaleString('es-CO')}`;
      const whatsappNumber = '573332853220';
      const url = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`;
      window.open(url, '_blank');
      // Cierra el modal de resumen después de enviar
      closeSummaryModal();
    });

    // Configurar botones de cantidad en el modal del producto
    document.getElementById('qty-minus').addEventListener('click', () => {
      const qtyInput = document.getElementById('item-qty');
      let value = parseInt(qtyInput.value) || 1;
      if (value > 1) qtyInput.value = value - 1;
    });
    document.getElementById('qty-plus').addEventListener('click', () => {
      const qtyInput = document.getElementById('item-qty');
      let value = parseInt(qtyInput.value) || 1;
      qtyInput.value = value + 1;
    });
    // Cerrar modal de producto
    document.getElementById('item-modal-close').addEventListener('click', closeItemModal);
    // Agregar producto desde el modal
    document.getElementById('item-add-btn').addEventListener('click', () => {
      const quantity = parseInt(document.getElementById('item-qty').value) || 1;
      const comment = document.getElementById('item-comment').value.trim();
      // Obtener la opción seleccionada, si existe
      const optionsContainer = document.getElementById('item-options-container');
      let selectedOption = null;
      if (optionsContainer.style.display !== 'none') {
        const selectEl = document.getElementById('item-options');
        selectedOption = selectEl.value || null;
      }
      addItemToOrder(currentCategory, currentIndex, quantity, comment, selectedOption);
      closeItemModal();
    });
    // Mostrar resumen al hacer clic en el botón flotante
    document.getElementById('view-summary-btn').addEventListener('click', openSummaryModal);
    // Cerrar resumen desde su botón
    document.getElementById('summary-modal-close').addEventListener('click', closeSummaryModal);
  </script>
</body>
</html>
